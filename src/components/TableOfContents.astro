---
// https://cosmicthemes.com/blog/astro-table-of-contents-component/#creating-the-table-of-contents-component

import type { MarkdownHeading } from 'astro';

interface Props {
  headings: MarkdownHeading[];
  levels?: number;
}

const { headings, levels = 2 } = Astro.props;

// Filter headings to only show up to the specified level
const filteredHeadings = headings.filter((heading) => heading.depth <= levels);
---

<nav class="rounded-lg border border-stone-200 bg-stone-50/50 p-4 text-sm">
  <h4
    class="text-xs font-semibold text-[var(--color-copper)] uppercase tracking-wider mb-3"
  >
    On this page
  </h4>
  <ul class="flex flex-col gap-1.5">
    {
      filteredHeadings.map((heading) => (
        <li
          class:list={{
            '': heading.depth === 2,
            'pl-3 border-l border-stone-200': heading.depth === 3,
          }}
        >
          <a
            href={`#${heading.slug}`}
            class="toc-link block py-1 text-stone-500 hover:text-[var(--color-copper)] transition-colors duration-200 leading-snug"
          >
            {heading.text}
          </a>
        </li>
      ))
    }
  </ul>
</nav>

<script src="../scripts/toc.ts"></script>
