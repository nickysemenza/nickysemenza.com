---
// https://cosmicthemes.com/blog/astro-table-of-contents-component/#creating-the-table-of-contents-component

import type { MarkdownHeading } from 'astro';

interface Props {
  headings: MarkdownHeading[];
  levels?: number;
}

const { headings, levels = 2 } = Astro.props;

// Filter headings to only show up to the specified level
const filteredHeadings = headings.filter((heading) => heading.depth <= levels);
---

<div class="toc-wrapper relative">
  <nav
    class="toc-nav scrollbar-hidden rounded-lg border border-stone-200 bg-stone-50/50 p-4 text-sm max-h-[calc(100vh-8rem)] overflow-y-auto"
  >
    <h4
      class="text-xs font-semibold text-[var(--color-accent)] uppercase tracking-wider mb-3"
    >
      On this page
    </h4>
    <ul class="flex flex-col gap-1.5">
      {
        filteredHeadings.map((heading) => (
          <li
            class:list={{
              '': heading.depth === 2,
              'pl-3 border-l border-stone-200': heading.depth === 3,
            }}
          >
            <a
              href={`#${heading.slug}`}
              class="toc-link block py-1 text-stone-500 hover:text-[var(--color-accent)] transition-colors duration-200 leading-snug"
            >
              {heading.text}
            </a>
          </li>
        ))
      }
    </ul>
  </nav>
  <!-- Scroll indicators -->
  <div
    class="toc-fade-top pointer-events-none absolute top-0 left-0 right-0 h-12 rounded-t-lg bg-gradient-to-b from-stone-50 to-transparent opacity-0 transition-opacity duration-200"
  >
  </div>
  <div
    class="toc-fade-bottom pointer-events-none absolute bottom-0 left-0 right-0 h-12 rounded-b-lg bg-gradient-to-t from-stone-50 to-transparent opacity-0 transition-opacity duration-200"
  >
  </div>
</div>

<script src="../scripts/toc.ts"></script>
