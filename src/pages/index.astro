---
import { SITE_TITLE, SITE_DESCRIPTION } from '@/consts';
import Container from '@/components/Container.astro';
import BaseLayout from '@/layouts/BaseLayout.astro';
import ProjectCard from '@/components/ProjectCard.astro';
import { Icon } from 'astro-icon/components';
import { getAllProjects, getProjectBySlug } from '@/lib/projects';

const allProjects = await getAllProjects();

// Curated featured projects (large cards)
const featuredProjectsSlugs = ['kitchen-renovation', 'backyard-renovation'];
const featuredProjects = featuredProjectsSlugs
  .map((slug) => getProjectBySlug(allProjects, slug))
  .filter((p) => p !== undefined);

// Curated other work (compact cards)
const otherWorkSlugs = ['cloudflare', 'photography', 'mason-jar-spice-rack'];
const otherWork = otherWorkSlugs
  .map((slug) => getProjectBySlug(allProjects, slug))
  .filter((p) => p !== undefined);
---

<BaseLayout title={SITE_TITLE} description={SITE_DESCRIPTION}>
  <!-- Projects Section - Now the main focus -->
  <section
    class="pt-8 sm:pt-12 pb-12 sm:pb-16 md:pb-20 bg-white construction-grid"
  >
    <Container>
      <div class="grid md:grid-cols-2 gap-6 sm:gap-8">
        {
          featuredProjects.map((project, index) => (
            <div
              class="reveal reveal-scale"
              style={`--reveal-delay: ${index * 100}ms`}
            >
              <ProjectCard
                project={project}
                variant="featured"
                loading={index === 0 ? 'eager' : 'lazy'}
              />
            </div>
          ))
        }
      </div>

      <!-- Other Work -->
      <div class="mt-10 sm:mt-16">
        <div class="grid sm:grid-cols-3 gap-4 sm:gap-5 items-stretch">
          {
            otherWork.map((project, index) => (
              <div
                class="reveal h-full"
                style={`--reveal-delay: ${(index + 2) * 100}ms`}
              >
                <ProjectCard project={project} variant="compact" />
              </div>
            ))
          }
        </div>
        <div class="mt-8 text-center">
          <a
            href="/projects"
            class="inline-flex items-center gap-2 text-sm font-medium text-stone-600 hover:text-[var(--color-accent)] transition-colors"
          >
            View all projects
            <Icon name="tabler:arrow-right" class="w-4 h-4" />
          </a>
        </div>
      </div>
    </Container>
  </section>

  <!-- Photos Section -->
  <section class="py-12 sm:py-16 bg-stone-800">
    <Container>
      <div
        class="flex flex-col sm:flex-row sm:items-end justify-between gap-4 mb-6 sm:mb-8 reveal"
      >
        <div>
          <h2
            class="text-xs sm:text-sm font-semibold text-[var(--color-accent-light)] uppercase tracking-wider mb-1 sm:mb-2"
          >
            Photography
          </h2>
          <p class="text-xl sm:text-2xl font-bold text-white">Recent photos</p>
        </div>
        <a
          href="https://nicky.photos"
          target="_blank"
          rel="noopener noreferrer"
          class="text-sm font-medium text-stone-400 hover:text-[var(--color-accent-light)] transition-colors duration-200 flex items-center gap-1"
        >
          View portfolio
          <Icon name="tabler:external-link" class="w-4 h-4" />
        </a>
      </div>
      <div class="rounded-xl overflow-hidden shadow-2xl reveal reveal-scale">
        <iframe
          src="https://www.nicky.photos/frame/slideshow?key=wXtF6f&autoStart=1&captions=1&navigation=1&playButton=0&randomize=1&speed=2&transition=fade&transitionSpeed=1"
          width="100%"
          height="400"
          class="sm:h-[500px] bg-stone-900"
          loading="lazy"
          title="Featured photos slideshow from nicky.photos"></iframe>
      </div>
    </Container>
  </section>

  <script src="@/scripts/reveal.ts"></script>
</BaseLayout>
